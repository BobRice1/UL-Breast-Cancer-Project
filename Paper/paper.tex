\documentclass[reprint, aps, prl]{revtex4-2}

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\graphicspath{{../Figures/}}

\raggedbottom
\begin{document}

\small

\title{Low-Dimensional Structure in Breast Cancer Cytology Revealed by Unsupervised Learning}


\author{Gillian Macdonald}
\author{Lenka Okasova}
\author{Bob Rice}
\altaffiliation{All figures were generated using custom Python code written by the authors.
The full analysis and figure-generation pipeline is available at
\url{https://github.com/BOBRICE1/UL-BREAST-CANCER-PROJECT}.}
\affiliation{School of Physics and Astronomy, University of Nottingham, UK}

\begin{abstract}
Unsupervised learning provides a principled framework for uncovering the latent structure in biomedical data independently of externally imposed diagnostic labels. In this paper, we analyse cytological measurements from the Breast Cancer Wisconsin (Original) dataset ~\cite{Wolberg1990Dataset} using principal component analysis (PCA) followed by k-means clustering to assess whether differences in pathological structure of benign and malignant tumours emerge directly from feature correlations alone. We find that strong correlations among size- and shape-related features induce a pronounced low-dimensional structure, with the first two principal components (PCs) capturing approximately 74\% of the total variance (80\% with three components), reflecting coordinated morphological variation rather than independent variables. Clustering in this reduced space, evaluated post hoc, shows strong agreement with diagnostic labels (adjusted Rand index 0.84), despite the absence of supervision. Importantly, the observed partial separation and substantial class overlap highlight the continuous and heterogeneous nature of tumour morphology, demonstrating that clinically relevant information is embedded in the statistical organisation of cytological features rather than isolated variables.
\end{abstract}

\maketitle

\section{Introduction}
Breast cancer diagnosis relies on quantitative analysis of cytological morphology, where systematic differences in cell size, shape, and nuclear properties are indicative of malignancy ~\cite{Wolberg1990}. Advances in digital cytology enable multivariate tumour feature extraction, motivating data-driven exploration of cellular structure beyond individual measurements ~\cite{Street1993}.
Despite high diagnostic accuracy of supervised methods, unsupervised analysis remains important for understanding intrinsic tumour structure and interpretability. Accordingly, such approaches provide complementary insight into whether clinically relevant structure emerges directly from feature-space regularities. PCA allows the identification of dominant directions of shared variance among correlated features~\cite{Jolliffe2002}. Moreover, clustering of reduced representations reveals intrinsic groupings and enables unsupervised comparison with diagnostic categories ~\cite{MacQueen1967}.
Here, we apply unsupervised learning methods to the Breast Cancer Wisconsin (Original) dataset ~\cite{Wolberg1990Dataset} to test whether benign and malignant tumours occupy distinct regions in cytological feature space. We show that correlated cytological features induce a low-dimensional structure in which the two diagnostic classes are partially separable, even without label information. Importantly, dominant variance axes principal component one (PC1) and two (PC2) capture clinically meaningful morphological distinctions, demonstrating the value of simple unsupervised methods for biomedical structure discovery.
We hypothesise that intrinsic correlations among cytological features induce a low-dimensional structure that partially separates benign and malignant tumours without supervision. 

\section{Methods}

\paragraph{Dataset and preprocessing:} We analysed the Breast Cancer Wisconsin (Original) dataset ~\cite{Wolberg1990Dataset} from the UCI Machine Learning Repository, consisting of 699 cytology samples annotated as benign or malignant. Each sample is described by nine ordinal-valued features capturing graded assessments of cell size, shape, adhesion, nuclear properties, and mitotic activity derived from fine needle aspirates. Samples containing missing values were removed prior to analysis, leaving N = 683 samples, and diagnostic labels were retained solely for \textit{post hoc} evaluation and visualisation. All features were standardised to zero mean and unit variance using the sample standard deviation (N-1 normalisation) prior to analysis. Although features are ordinal, treating them as approximately interval-scaled is standard for this dataset.

\paragraph{Correlation analysis:} To characterise dependencies among cytological features, we computed the Pearson correlation matrix
\begin{equation}
    r_{jk} = \frac{\sum_{i=1}^{N} (x_{ij} - \bar{x}_j)(x_{ik} - \bar{x}_k)}
    {\sqrt{\sum_{i=1}^{N}(x_{ij} - \bar{x}_j)^2 \,\sum_{i=1}^{N}(x_{ik} - \bar{x}_k)^2}}.
\end{equation}
where $x_{ij}$ denotes the value of feature $j$ for sample $i$ and $\bar{x}_j$ is the corresponding feature mean. Pearson correlation coefficients were used to characterise linear dependencies among approximately interval-scaled features. Strong inter-feature correlations were used to assess feature redundancy and motivate subsequent application of PCA. 

\paragraph{Principal component analysis:} Dimensionality reduction was performed using PCA fit to the standardised feature matrix without access to diagnostic labels. PCA was chosen due to its interpretability and its ability to identify dominant correlated directions in linear feature spaces. Following standardisation to zero mean and unit variance, the sample covariance matrix
\begin{equation}
\Sigma = \frac{1}{N-1} X^{\mathsf{T}} X ,
\end{equation}
was diagonalised by solving the eigenvalue problem
\begin{equation}
\Sigma \mathbf{v}_{\ell} = \lambda_{\ell} \mathbf{v}_{\ell}, 
\end{equation}
where $\lambda_{\ell}$ and $\mathbf{v}_{\ell}$ denote the eigenvalues and corresponding eigenvectors, ordered such that $\lambda_{1} \geq \lambda_{2} \geq \dots$. Each standardised data point $\mathbf{x}_i$ was projected onto the first $K$ principal components via
\begin{equation}
\mathbf{z}_i = V_K^{\mathsf{T}} \mathbf{x}_i ,
\end{equation}
where $V_K = [\mathbf{v}_1, \dots, \mathbf{v}_K]$. The number of retained components was selected based on the cumulative explained variance and inspection of the eigenvalue spectrum.
\paragraph{Unsupervised clustering:} Clustering was performed in the reduced PCA space using the k-means algorithm. The number of clusters was fixed to $k=2$, corresponding to the two diagnostic categories in the dataset, while diagnostic labels were used only for  \textit{post hoc} evaluation. Because k-means is sensitive to initial centroid placement and can converge to local minima, $k$-means++ initialisation was used with 30 random restarts (fixed seed), and the minimum-inertia solution was retained.
\begin{equation}
\mathcal{L} = \sum_{i=1}^{N} \min_{k} \left\lVert \mathbf{z}_i - \boldsymbol{\mu}_k \right\rVert^{2}.
\end{equation}
Given cluster centroids $\boldsymbol{\mu}_k$, sample assignments were obtained by minimising the sum of squared distances to the nearest centroid. 

\paragraph{Evaluation:}Clustering performance was assessed \textit{post hoc} using the adjusted Rand index (ARI), 
\begin{equation}
\mathrm{ARI} =
\frac{\mathrm{RI} - \mathbb{E}[\mathrm{RI}]}
{\max(\mathrm{RI}) - \mathbb{E}[\mathrm{RI}]},
\end{equation}
which quantifies agreement between inferred cluster assignments and reference diagnostic labels while correcting for chance. An ARI value close to unity indicates strong agreement.

\section{Results}
Strong correlations are observed among multiple cytological features, particularly those related to cell size and shape (Fig.~\ref{fig:correlation}). Pairwise Pearson correlation coefficients among these features frequently exceed $r \approx 0.7$, indicating substantial redundancy in the ordinal feature space. In contrast, features associated with mitotic activity and nuclear characteristics exhibit weaker correlations with other variables ($r \lesssim 0.5$), suggesting partially independent sources of variability. These patterns indicate that a large fraction of the dataset variance is shared across a subset of morphologically related features, motivating dimensionality reduction and underlying the dominance of the first principal component.
\begin{figure}[t]
\centering
\includegraphics[width=\linewidth]{PearsonCorrelationMatrix.png}
\caption{Pearson correlation matrix of the nine cytological features in the Breast Cancer Wisconsin (Original) dataset, showing strong size- and shape-related dependencies that motivate dimensionality reduction.}
\label{fig:correlation}
\end{figure}

Principal component analysis reveals a rapidly decaying eigenvalue spectrum (Fig.~\ref{fig:variance}). The first principal component accounts for approximately $65\%$ of the total variance, with the second contributing an additional $9\%$, such that the first two components together explain $74\%$ of the variance. Including a third component increases the cumulative explained variance to approximately $80\%$, with diminishing contributions from higher-order components. Inspection of the PCA loadings (Fig.~\ref{fig:loadings}) shows that PC1 is dominated by size- and shape-related features, while PC2 receives stronger contributions from nuclear-related characteristics, indicating partially independent axes of morphological variation.

\begin{figure}[t]
\centering
\includegraphics[width=\linewidth]{pca_variance.png}
\caption{Individual (bars) and cumulative (points) variance explained by principal components, showing that the first two PCs capture $74\%$ of the total variance ($80\%$ with the inclusion of a third), consistent with a low-dimensional structure.}
\label{fig:variance}
\end{figure}
Projection of tumour samples onto the first two principal components reveals partial separation between benign and malignant classes (Fig.~\ref{fig:kmeans}), with separation occurring primarily along PC1. Clustering in this reduced space yields two dominant groupings whose centroids are displaced along the axis associated with size- and shape-related features, consistent with the interpretation of PC1 as a global morphological variation axis. Despite the absence of supervision, the resulting cluster assignments show strong quantitative agreement with diagnostic labels, yielding an adjusted Rand index of $\mathrm{ARI}=0.84$ in \textit{post hoc} comparison.

Although clustering achieves strong agreement, substantial overlap remains, particularly for samples near the decision boundary. Misclassified tumours predominantly exhibit intermediate morphological characteristics, suggesting intrinsic biological ambiguity and measurement noise rather than algorithmic failure. Clustering performance remains high across PCA representations of varying dimensionality, with adjusted Rand indices ranging from 0.83 to 0.86 (Table~\ref{tab:ari}). Strong agreement is already achieved using only the first two principal components, with only modest and non-monotonic variation upon inclusion of additional dimensions, indicating that diagnostically relevant structure is captured by a small number of correlated feature combinations.
\begin{figure}[t]
\centering
\includegraphics[width=0.7\linewidth]{pca_loadings_pc1.png}
\hfill
\includegraphics[width=0.7\linewidth]{pca_loadings_pc2.png}
\caption{Feature loadings for the first (top) and second (bottom) principal components. PC1 is dominated by size- and shape-related features, while PC2 shows stronger contributions from nuclear-related characteristics, reflecting distinct sources of biological variability. The sign of each loading value indicates the direction of feature contribution along the principal component axis, while its magnitude reflects relative importance.}
\label{fig:loadings}
\end{figure}

\begin{figure}[t]
\centering
\includegraphics[width=\linewidth]{K-means_pca.png}
\caption{$K$-means clustering of tumour samples projected onto the first two PCs. Points are coloured by computed cluster assignment, with crosses indicating cluster centroids. Diagnostic labels are shown for visualisation only and were not used during clustering. Separation occurs primarily along the dominant variance axis (PC1), with substantial class overlap.}
\label{fig:kmeans}
\end{figure}
\begin{table}[t]
\centering
\caption{Adjusted Rand Index (ARI) between $k$-means cluster assignments and diagnostic labels as a function of the number of retained principal components. ARI is reported for the minimum-inertia solution over 30 $k$-means++ initialisations and used solely for \textit{post hoc} evaluation.}
\label{tab:ari}
\begin{ruledtabular}
\begin{tabular}{ccccc}
Principal components & 2 & 3 & 5 & 9 \\
\hline
ARI & 0.847 & 0.847 & 0.847 & 0.836 \\
\end{tabular}
\end{ruledtabular}
\end{table}

\section{Conclusion}
We have shown that unsupervised analysis of breast cancer cytological data reveals a pronounced low-dimensional structure that aligns closely with pathological distinctions between benign and malignant tumours. Principal component analysis identifies dominant variance directions driven primarily by correlated size- and shape-related features, capturing the majority of variability in the dataset. The emergence of strong agreement between unsupervised cluster assignments and diagnostic labels indicates that clinically relevant information is encoded directly in the statistical organisation of cytological features, rather than imposed by supervised decision rules.
Importantly, the observed partial separation and persistent overlap between classes suggest that tumour morphology varies continuously along shared latent axes, with diagnostic labels defining discrete categories within a continuous morphological distribution. Misclassified samples predominantly occupy intermediate regions of feature space, consistent with biological heterogeneity and measurement uncertainty rather than algorithmic failure. This analysis is limited by the linear nature of PCA and the treatment of ordinal features as approximately continuous, which may obscure nonlinear structure or finer-grained subgroups. Nevertheless, these assumptions are sufficient to reveal the dominant structure of the data. Future work could explore nonlinear or mixture-based unsupervised models to further characterise morphological heterogeneity and transitional tumour phenotypes.


\begin{thebibliography}{9}
\bibitem{Wolberg1990Dataset}
W. H. Wolberg,
Breast Cancer Wisconsin (Original) dataset;
UCI Machine Learning Repository (1990),
https://doi.org/10.24432/C5HP4Z.
\bibitem{Wolberg1990}
W. H. Wolberg, O. L. Mangasarian,
Multisurface method of pattern separation for medical diagnosis applied to breast cytology,
Proc. Natl. Acad. Sci. U.S.A. 87, 9193 (1990).
\bibitem{Street1993}
W. N. Street, W. H. Wolberg, and O. L. Mangasarian,
Nuclear feature extraction for breast tumor diagnosis,
Proc. IS\&T/SPIE Symp. Electronic Imaging: Science and Technology \textbf{1905}, 861 (1993).
\bibitem{Jolliffe2002}
I. T. Jolliffe,
\textit{Principal Component Analysis},
(Springer, New York, 2002).
\bibitem{MacQueen1967}
J. MacQueen,
Some methods for classification and analysis of multivariate observations,
in \textit{Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability}
(University of California Press, Berkeley, 1967), pp. 281â€“297.

\end{thebibliography}

\end{document}
